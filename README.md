<p><a href="https://github.com/potiuk/get-workflow-origin/actions">
<img alt="get-workflow-origin status"
    src="https://github.com/potiuk/get-workflow-origin/workflows/Test%20the%20build/badge.svg"></a>

# Get Workflow Runs action


<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [Context and motivation](#context-and-motivation)
- [Inputs and outputs](#inputs-and-outputs)
  - [Inputs](#inputs)
  - [Outputs](#outputs)
  - [Development environment](#development-environment)
  - [License](#license)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# Context and motivation

Get Workflow Origin is an action that provides missing information for `workflow_run` events
Often in the `workflow_run` event you want to get more information about the source run than the
one provided directly via GitHub context. For example you would like to know what is the merge
commit generated by pull request in case the workflow was triggered by a pull request.

This action provides outputs that give the missing information. You should add this action as first
one in the "workflow_run" event and then you will be able to use those outputs.

# Inputs and outputs

## Inputs

| Input                   | Required | Default      | Comment                                                                                                                                                                                                          |
|-------------------------|----------|--------------|-----------------------------------------------------------------------------------------------------|
| `token`                 | yes      |              | The github token passed from `${{ secrets.GITHUB_TOKEN }}`                                          |
| `sourceRunId`           | yes      |              | It should be set to the id of the workflow triggering the run `${{ github.event.workflow_run.id }}` |

## Outputs

| Output              | No `sourceRunId` specified                              | The `sourceRunId` set to `${{ github.event.workflow_run.id }}`                                       |
|---------------------|---------------------------------------------------------|------------------------------------------------------------------------------------------------------|
| `sourceHeadRepo`    | Current repository. Format: `owner/repo`                | Repository of the run that triggered this `workflow_run`. Format: `owner/repo`                       |
| `sourceHeadBranch`  | Current branch.                                         | Branch of the run that triggered this `workflow_run`. Might be forked repo, if it is a pull_request. |
| `sourceHeadSha`     | Current commit SHA: `{{ github.sha }}`                  | Commit sha of the run that triggered this `workflow_run`.                                            |
| `mergeCommitSha`    | Merge commit SHA if PR-triggered event.                 | Merge commit SHA if PR-triggered event.                                                              |
| `targetCommitSha`   | Target commit SHA (merge if present, otherwise source). | Target commit SHA (merge if present, otherwise source).                                              |
| `pullRequestNumber` | Number of the associated Pull Request (if PR triggered) | Number of the associated Pull Request (if PR triggered)                                              |
| `sourceEvent`       | Current event: ``${{ github.event }}``                  | Event of the run that triggered this `workflow_run`                                                  |

## Development environment

It is highly recommended tu use [pre commit](https://pre-commit.com). The pre-commits
installed via pre-commit tool handle automatically linting (including automated fixes) as well
as building and packaging Javascript index.js from the main.ts Typescript code, so you do not have
to run it yourself.

## License
[MIT License](LICENSE) covers the scripts and documentation in this project.
